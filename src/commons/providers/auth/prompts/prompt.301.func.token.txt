아래의 조건을 모두 적용하여, 아래의 요구사항을 모두 구현할 것.
구현 결과를 체크리스트로 반환할 것.

==============================================

조건-커서룰) 아래의 커서룰을 적용하여 작업하고, 이 작업이 끝나면 해당 rules 적용 결과를 체크리스트로 반환할 것.
            - @01-common.mdc
            - @04-func.mdc

==============================================

조건-파일경로) 수정될 TSX 파일경로: src/commons/providers/auth/auth.provider.tsx
조건-파일경로) 수정될 GraphQL 쿼리 파일경로: src/components/auth-login/hooks/index.form.hook.tsx
조건-파일경로) 구현될 TEST 파일경로: src/commons/providers/auth/tests/index.token-expiration.spec.ts

==============================================

핵심요구사항) 다음의 기능을 playwright 테스트를 활용하여 TDD 기반으로 구현하고, 테스트에 통과할 때까지 반복할 것.

1) 테스트 제외 라이브러리
- jest
- @testing-library/react

2) 테스트 조건
- timeout은 설정하지 않거나, 500ms 미만으로 설정할 것.
- 페이지가 완전히 로드된 후 테스트할 것.
  - 페이지 로드 식별 요구사항: 고정식별자 data-testid 대기 방법
  - **중요금지사항** 페이지 로드 식별 금지사항: networkidle 대기 방법

3) 테스트 API 조건
3-1) 데이터
- 실제 API 데이터를 사용할 것.
- Mock 데이터를 사용하지 말 것.

3-2) 성공 시나리오
- 로그인 후 토큰 만료 시간이 localStorage에 저장됨
- 토큰 만료 시간이 현재 시간을 넘으면 자동 로그아웃

3-3) 실패 시나리오
- 토큰 만료 정보가 없는 경우 처리
- 로그아웃 전에 페이지 포커스 시에도 만료 여부 재확인

4) 데이터 조건
    - 저장소: 백엔드 서버(GraphQL API)
    - 요청방식: LoginUser mutation
    - 현재 요청 응답 구조:
      mutation LoginUser($email: String!, $password: String!) {
        loginUser(email: $email, password: $password) {
          accessToken
        }
      }

핵심요구사항) index.form.hook.tsx에서 로그인 성공 시 토큰 유효기간(expiresIn, 초 단위)을 설정하여 login() 함수에 전달할 것.

**용어 정의:**
- expiresIn: 토큰의 유효기간 (초 단위, 예: 3600초 = 1시간)
- tokenExpiresAt: 토큰이 만료되는 시간 (타임스탐프, 밀리초 단위)

1) 파일 위치: src/components/auth-login/hooks/index.form.hook.tsx (82-127번 줄)
2) 수정 사항
  - onCompleted 콜백에서 expiresIn(토큰 유효기간) 설정
  - 서버에서 expiresIn이 전달되면 사용, 없으면 3600초(1시간) 기본값 사용
    const expiresIn = data.loginUser.expiresIn || 3600; // expiresIn이 없으면 3600초(1시간) 기본값
  - login() 함수 호출 시 expiresIn을 세 번째 파라미터로 전달:
    login(userInfo, pendingAccessToken, expiresIn)
3) Auth Provider의 login() 함수 시그니처 수정
  - 파일: src/commons/providers/auth/auth.provider.tsx
  - 기존: const login = useCallback((userData: any, accessToken: string): void => { ... }, [router])
  - 수정: const login = useCallback((userData: any, accessToken: string, expiresIn: number = 3600): void => { ... }, [router])

핵심요구사항) Auth Provider에서 토큰 만료 시간을 관리하고 자동 로그아웃할 것.
1) localStorage에 저장할 데이터
  - ACCESS_TOKEN_KEY: "accessToken" → 기존 (변경 없음)
  - TOKEN_EXPIRES_AT_KEY: "tokenExpiresAt" → 새로 추가 (타임스탐프, 밀리초 단위)
  - USER_KEY: "user" → 기존 (변경 없음)

2) login() 함수 수정
  - expiresIn(초 단위의 토큰 유효기간)을 받아서 현재 시간에 expiresIn(초)을 더하여 tokenExpiresAt(토큰 만료 시간) 계산
  - tokenExpiresAt을 localStorage에 저장 (타임스탐프, 밀리초 단위)
  - 계산 공식: tokenExpiresAt = Date.now() + (expiresIn * 1000)
  - 계산 예시: expiresIn이 3600초면, tokenExpiresAt = Date.now() + 3600000 (밀리초)

3) checkAuthStatus() 함수 수정
  - localStorage에서 tokenExpiresAt을 가져올 것
  - 현재 시간이 tokenExpiresAt을 넘으면 토큰이 만료된 것으로 판단
  - 만료된 경우 자동으로 logout() 호출
  - 로직: if (Date.now() >= tokenExpiresAt) { logout() }

4) 타이머 설정 (useEffect)
  - checkAuthStatus()가 마운트될 때 호출되는 것 외에도,
  - tokenExpiresAt(만료 시간)까지의 남은 시간만큼 타이머를 설정하여 정확한 시간에 자동 로그아웃
  - 타이머 설정 공식: setTimeout(() => { logout() }, tokenExpiresAt - Date.now())
  - 타이머 설정 예시: tokenExpiresAt이 1시간 뒤라면, setTimeout(() => { logout() }, 3600000)
  - 언마운트 시 타이머 정리 (clearTimeout)

5) 페이지 포커스 이벤트 추가
  - window의 'focus' 이벤트 리스너 추가
  - 페이지 포커스 시 checkAuthStatus() 호출하여 만료 여부 재확인
  - 이유: 다른 탭에서 오래 있다가 돌아온 경우, 만료되었을 수 있으므로

핵심요구사항) 테스트 케이스를 작성하여 다음을 검증할 것.
1) 로그인 후 tokenExpiresAt이 localStorage에 저장되는가
2) 현재 시간이 tokenExpiresAt을 넘으면 자동 로그아웃되는가
3) 페이지 포커스 이벤트 발생 시 만료 여부가 재확인되는가
4) 타이머가 정확한 시간에 로그아웃을 실행하는가
```

// === 변경 주석 (자동 생성) ===
// 시각: 2025-10-29 16:25:35
// 변경 이유: 요구사항 반영 또는 사소한 개선(자동 추정)
// 학습 키워드: 개념 식별 불가(자동 추정 실패)

